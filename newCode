import pandas as pd

def load_test_cases(file_path):
    # Load the Excel file
    df = pd.read_excel(file_path)
    return df

def create_test_data(df):
    # Dictionary to hold test cases
    test_data = {}
    
    current_summary = ""
    
    for index, row in df.iterrows():
        # If the summary is not empty, update the current summary
        if pd.notna(row['Summary']):
            current_summary = row['Summary']
        
        # If current_summary exists, create a test case entry
        if current_summary:
            if current_summary not in test_data:
                test_data[current_summary] = {
                    "test_steps": []
                }
        
            # Add the test step, expected result, and test data
            test_data[current_summary]["test_steps"].append({
                "test_step": row['Test Step'],
                "expected_result": row['Expected Result'],
                "test_data": row['Test Data']
            })
    
    return test_data

def save_test_data(test_data, output_file):
    # Save the test data to a JSON file
    import json
    with open(output_file, 'w') as outfile:
        json.dump(test_data, outfile, indent=4)

def main():
    file_path = "test_cases.xlsx"  # Replace with your Excel file path
    output_file = "test_data.json"  # The file where test data will be saved
    
    df = load_test_cases(file_path)
    test_data = create_test_data(df)
    
    # Save the test data set to a file
    save_test_data(test_data, output_file)
    
    print(f"Test data set saved to {output_file}")

if __name__ == "__main__":
    main()
